<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizador MST + H√∫ngaro - Log√≠stica Agr√≠cola</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style-mst.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <header>
                <h1>üåæ RutaOptima</h1>
                <p>Optimizaci√≥n MST + H√∫ngaro</p>
            </header>
            
            <div class="controls">
                <div class="mode-selector">
                    <h3>Modo de Entrada</h3>
                    <div class="mode-buttons">
                        <button id="mode-hub" class="mode-btn active" data-mode="hub">
                            üè≠ Hub
                        </button>
                        <button id="mode-silos" class="mode-btn" data-mode="silos">
                            üåæ Silos
                        </button>
                        <button id="mode-trucks" class="mode-btn" data-mode="trucks">
                            üöö Camiones
                        </button>
                    </div>
                </div>

                <div class="examples-section">
                    <h3>Ejemplos Pre-cargados</h3>
                    <select id="example-select" class="example-select">
                        <option value="">-- Seleccionar Escenario --</option>
                        <option value="small">Peque√±o (3 Silos)</option>
                        <option value="medium">Mediano (5 Silos)</option>
                        <option value="large">Grande (8 Silos)</option>
                        <option value="asymmetric">Asim√©trico (Prueba)</option>
                    </select>
                    <button id="load-example-btn" class="btn-example" disabled>
                        üìÇ Cargar Ejemplo
                    </button>
                </div>

                <div id="status-panel" class="status-panel">
                    <div class="status-item">
                        <span class="status-label">Hub:</span>
                        <span id="hub-status">‚ùå No establecido</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Silos:</span>
                        <span id="silos-status">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Camiones:</span>
                        <span id="trucks-status">0</span>
                    </div>
                </div>

                <div id="instructions" class="instructions">
                    Haz clic en el mapa para colocar el HUB (Centro de Acopio)
                </div>
                
                <div id="items-list" class="items-list"></div>

                <div class="action-buttons">
                    <button id="optimize-btn" class="btn-primary" disabled>
                        ‚ö° Optimizar Red + Asignaci√≥n
                    </button>
                    <button id="clear-btn" class="btn-secondary">
                        üóëÔ∏è Limpiar Todo
                    </button>
                </div>
            </div>
            
            <div id="cost-matrix-panel" class="cost-matrix-panel hidden">
                <h3>üìä Matriz de Costos (M√©todo H√∫ngaro)</h3>
                <div class="matrix-info">
                    Distancias de cada cami√≥n a cada silo (km)
                </div>
                <div id="cost-matrix-container" class="cost-matrix-container"></div>
            </div>
            
            <div id="results" class="results-panel hidden">
                <h3>üìä Resultados</h3>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-label">Red de Recolecci√≥n (MST)</div>
                        <div class="metric-value" id="mst-cost">-- km</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Posicionamiento (H√∫ngaro)</div>
                        <div class="metric-value" id="hungarian-cost">-- km</div>
                    </div>
                    
                    <div class="metric-card highlight">
                        <div class="metric-label">Costo Total Optimizado</div>
                        <div class="metric-value" id="total-optimized">-- km</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Baseline (Ingenuo)</div>
                        <div class="metric-value" id="total-baseline">-- km</div>
                    </div>
                    

                </div>

                <div id="assignment-details" class="assignment-details"></div>
                
                <button id="animate-btn" class="btn-animate" style="margin-top: 1rem;">
                    üé¨ Ver Animaci√≥n de Trayectos
                </button>
            </div>
            
            <div id="animation-controls" class="animation-controls hidden">
                <h3>üé¨ Control de Animaci√≥n</h3>
                <div id="animation-status" class="animation-status">
                    Preparando...
                </div>
                <div class="progress-bar-container">
                    <div id="animation-progress-bar" class="progress-bar"></div>
                </div>
                <div class="animation-buttons">
                    <button id="play-animation-btn" class="btn-control">‚ñ∂Ô∏è Reproducir</button>
                    <button id="pause-animation-btn" class="btn-control">‚è∏Ô∏è Pausar</button>
                    <button id="stop-animation-btn" class="btn-control">‚èπÔ∏è Detener</button>
                </div>
                <div class="speed-controls">
                    <label>Velocidad:</label>
                    <select id="animation-speed">
                        <option value="1">Normal (1x)</option>
                        <option value="2">R√°pida (2x)</option>
                        <option value="5">Muy R√°pida (5x)</option>
                    </select>
                </div>
            </div>
        </aside>

        <main class="map-container">
            <div id="map"></div>
            <div class="map-legend">
                <div class="legend-item">
                    <span class="legend-marker" style="background: #dc2626;">üè≠</span>
                    Hub (Centro)
                </div>
                <div class="legend-item">
                    <span class="legend-marker" style="background: #2563eb;">üåæ</span>
                    Silos
                </div>
                <div class="legend-item">
                    <span class="legend-marker" style="background: #f97316;">üöö</span>
                    Camiones
                </div>
                <div class="legend-item">
                    <span class="legend-line mst-line"></span>
                    Red MST
                </div>
                <div class="legend-item">
                    <span class="legend-line assignment-line"></span>
                    Asignaci√≥n
                </div>
            </div>
        </main>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- Algorithms -->
    <script src="js/mst.js"></script>
    <script src="js/hungarian.js"></script>
    <script src="js/osrm.js"></script>
    <script src="js/optimizer.js"></script>
    <script src="js/examples.js"></script>
    <script src="js/route-animation.js"></script>
    <!-- App Logic -->
    <script src="js/app-mst.js"></script>
</body>
</html>
